{
  "summary": {
    "title": "MegaTravel Threat Model",
    "owner": "Team MegaTravel",
    "description": "Threat model for MegaTravel reservation system",
    "reviewer": "Security Architect",
    "contributors": [],
    "diagramType": "DFD"
  },
  "detail": {
    "diagrams": [
      {
        "title": "MegaTravel Reservation Flow",
        "diagramType": "DFD",
        "elements": [
          {
            "id": "actor-browser",
            "name": "Browser",
            "type": "Actor",
            "outOfScope": false,
            "description": "End user browser"
          },
          {
            "id": "process-webapp",
            "name": "Web Application",
            "type": "Process",
            "outOfScope": false,
            "description": "Web/API frontend"
          },
          {
            "id": "process-worker",
            "name": "Background Worker Process",
            "type": "Process",
            "outOfScope": false,
            "description": "Processes reservations and payments"
          },
          {
            "id": "datastore-db",
            "name": "Reservations Database",
            "type": "DataStore",
            "outOfScope": false,
            "description": "Stores reservation records"
          },
          {
            "id": "datastore-config",
            "name": "Config Store",
            "type": "DataStore",
            "outOfScope": false,
            "description": "Secrets and configuration"
          },
          {
            "id": "external-payment",
            "name": "Payment Processor",
            "type": "ExternalEntity",
            "outOfScope": false,
            "description": "External payment gateway"
          },
          {
            "id": "external-queue",
            "name": "Message Queue",
            "type": "ExternalEntity",
            "outOfScope": false,
            "description": "Queue for processing reservations"
          }
        ],
        "flows": [
          {
            "id": "flow1",
            "name": "Web Request",
            "source": "actor-browser",
            "target": "process-webapp",
            "description": "HTTPS request from user"
          },
          {
            "id": "flow2",
            "name": "Web Response",
            "source": "process-webapp",
            "target": "actor-browser",
            "description": "Response to user"
          },
          {
            "id": "flow3",
            "name": "Put Reservation Message",
            "source": "process-webapp",
            "target": "external-queue",
            "description": "Send reservation to queue"
          },
          {
            "id": "flow4",
            "name": "Process Message",
            "source": "external-queue",
            "target": "process-worker",
            "description": "Worker receives message"
          },
          {
            "id": "flow5",
            "name": "Update Reservation",
            "source": "process-worker",
            "target": "datastore-db",
            "description": "Update reservation status"
          },
          {
            "id": "flow6",
            "name": "Access Config",
            "source": "process-webapp",
            "target": "datastore-config",
            "description": "Read configuration"
          },
          {
            "id": "flow7",
            "name": "Access Config",
            "source": "process-worker",
            "target": "datastore-config",
            "description": "Read worker configuration"
          },
          {
            "id": "flow8",
            "name": "Payment API Call",
            "source": "process-worker",
            "target": "external-payment",
            "description": "Initiate payment"
          }
        ],
        "boundaries": [
          {
            "id": "boundary-dmz",
            "name": "DMZ",
            "description": "Public-facing DMZ zone",
            "type": "TrustBoundary"
          },
          {
            "id": "boundary-internal",
            "name": "Internal Network",
            "description": "Internal trusted network",
            "type": "TrustBoundary"
          }
        ]
      }
    ]
  }
}
